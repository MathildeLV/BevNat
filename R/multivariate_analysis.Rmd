---
title: "Multivariate analysis (log/linear regresssion and gam)"
author: "Mathilde Le Vu"
date:  "`r Sys.Date()`"
html_document: 
output:
  rmdformats::robobook:
    code_folding: show
    self_contained: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

# Logistic/linear regression models

## Birthweight
```{r}
#baseline model
m_BW1 <- lm(BW ~ GA_weeks + birth_Y_M_num + parity_cat + sex, data=bevn_eco_in7)
summary(m_BW1)

  #with mat age 
  m_BW1_matage_cont = update(m_BW1, . ~ . + mat_age)
  summary(m_BW1_matage_cont)

  #with mat age category
  m_BW1_matage_cat = update(m_BW1, . ~ . + mat_age_cat) 
  summary(m_BW1_matage_cat)
  
  #with mother nationality (categorical 1)
  m_BW1_mat_nat_cat1 = update(m_BW1_matage_cat, . ~ . + mother_nationality_cat1) 
  summary(m_BW1_mat_nat_cat1)
  
  #with mother nationality (categorical 2)
   m_BW1_mat_nat_cat2 = update(m_BW1_matage_cat, . ~ . + mother_nationality_cat2)  
  summary(m_BW1_mat_nat_cat2)
  
  #with urban category (categorical 3)
   m_BW1_urb = update(m_BW1_mat_nat_cat2, . ~ . + Urban3)  
  summary(m_BW1_urb)  

  #with mean ssep2
   m_BW1_ssep = update(m_BW1_urb, . ~ . + mean_ssep2)  
  summary(m_BW1_ssep)  
  
models <- mtable("m1: GA + birthmonth +  parity + sex"=m_BW1, "m2: m1 + mat.age cont."=m_BW1_matage_cont, "m3: m1 + mat.age.categ"=m_BW1_matage_cat, "m4: m3 + mother nationality_cat1"= m_BW1_mat_nat_cat1 , "m5: m3 + mother nationality_cat2"= m_BW1_mat_nat_cat2, "m6: m5+ Urban"=m_BW1_urb, "m7: m6+ ssep"=m_BW1_ssep, coef.style="ci.horizontal",
              summary.stats=c("Estimate","Pr(>|t|)","AIC")
         )
write_html(models, here("output", "summary_BW_lm_models.html")) 

anova(m_BW1_mat_nat_cat2,m_BW1_urb)
```

Based on the last model (m_BW1_urb_cat_3):
- GA: each gestational age increase of one week increase BW by 179g.
- Birthdate (month + year) seems to have a significant but irrelevant effect (-0.11g each month)
- Parity: with each category, the birthweight increases compared to primiparous women: +137g for parity=2, +185g for parity=3, +209g for parity >3.
- sex: females are 147g lighter than males
- maternal age (cat): compared to the reference category of 25-30yo, women of any other age category have lighter babies (all significant except for category 20-25), but the effect is worth noticing mainly for younger women (10-20), who have babies 23g lighter.
- mother nationality: compared to babies born from mother who have the Swiss nationality, babies born from Asian mothers are a bit lighter (-14g), while babies born from Europe (excl Switz), Northern America, Oceania or Southern/Central America are bigger (+31g, +53, +55, +43g respectively).
- Urbanicity: once SSEP is added to the model, being born in an urban area no longer increases by 4.5g birthweight.

## Stillbirth

```{r}
#baseline model (with maternal nationality categ1)
  m_SB_multiv_1 <- glm(stillbirth~mat_age_cat + BW + GA_weeks + birth_Y_M_num + mother_nationality_cat1, family= "binomial",data=bevn_eco_in6)
  summary(m_SB_multiv_1) 
  exp(coef(summary(m_SB_multiv_1)))[,"Estimate"]

#With mother nationality category 2
  m_SB_multiv_2 = update(m_SB_multiv_1, . ~ . - mother_nationality_cat1 + mother_nationality_cat2) 
  summary(m_SB_multiv_2) 
  exp(coef(summary(m_SB_multiv_2)))[,"Estimate"]

#adding Urbanicity, language and ssep
  m_SB_multiv_3 = update(m_SB_multiv_2, . ~ . + Language + mean_ssep2)
  summary(m_SB_multiv_3) 
  exp(coef(summary(m_SB_multiv_3)))[,"Estimate"]
  exp(confint(m_SB_multiv_3))
```

Based on the last model (m_SB_multiv_3):
- maternal age: compared to age 25-30, being over 35 increases the risk of having a stillborn baby: CI95% 1.06-1.31 for mothers 35-40yo, and CI95% 1.01-1.42 for mothers 40-70yo.
- increasing BW slightly decreases stillborn risk: CI95% 0.9983-0.9985
- Gestational age: increasing GA decreases risk of stillborn: CI95% 0.85-0.88
- Mother nationality: compared to babies born from Swiss-mothers, babies born from mothers with African nationality have an increased risk of being stillborn (pvalue borderline = 0.053), CI95% 0.99-1.44
- SSEP of the place of residence of the mother plays a minor role: the higher the ssep, the lower the risk of having a stillborn baby: CI95% 0.990-0.999 per ssep point increase
