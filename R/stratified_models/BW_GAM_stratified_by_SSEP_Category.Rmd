---
title: "BIRHTWEIGHT GAM stratified by SEP (3 groups, by tertiles)"
author: "Mathilde Le Vu"
date:  "`r Sys.Date()`"
html_document: 
output:
  rmdformats::robobook:
    code_folding: show
    self_contained: true
    highlight: pygments
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Unstratified model with categorical SSEP
## Category 1: tertile
```{r}
m_BW_bam5_2_SEP_cat1 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + mean_ssep2_cat1 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7)  
summary(m_BW_bam5_2_SEP_cat1)

  plot(m_BW_bam5_2_SEP_cat1, select=1, ylim=c(0, 4000),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat1)[1]) #GA
  plot(m_BW_bam5_2_SEP_cat1, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat1)[1]) #mat age
  plot(m_BW_bam5_2_SEP_cat1, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat1)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam5_2_SEP_cat1, select=4, ylim=c(3330, 3350),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat1)[1]) #month
  plot(m_BW_bam5_2_SEP_cat1, select=5, ylim=c(3150, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat1)[1]) #mean ssep

  beta <- coef(m_BW_bam5_2_SEP_cat1)
  Vb <- vcov(m_BW_bam5_2_SEP_cat1, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 1184367
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,20), 2) 
```

## Category 2: 5th and 95th percentiles
```{r}
m_BW_bam5_2_SEP_cat2 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + mean_ssep2_cat2 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7)  
summary(m_BW_bam5_2_SEP_cat2)

  plot(m_BW_bam5_2_SEP_cat2, select=1, ylim=c(0, 4000),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat2)[1]) #GA
  plot(m_BW_bam5_2_SEP_cat2, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat2)[1]) #mat age
  plot(m_BW_bam5_2_SEP_cat2, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat2)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam5_2_SEP_cat2, select=4, ylim=c(3330, 3350),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat2)[1]) #month
  plot(m_BW_bam5_2_SEP_cat2, select=5, ylim=c(3150, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat2)[1]) #mean ssep
  
  beta <- coef(m_BW_bam5_2_SEP_cat2)
  Vb <- vcov(m_BW_bam5_2_SEP_cat2, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 1184367
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,20), 2)
```

## Category 3: lowest 20% vs. middle (2nd to 4th quintiles) vs. highest 20%. 
```{r}
m_BW_bam5_2_SEP_cat3 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + mean_ssep2_cat3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7)  
summary(m_BW_bam5_2_SEP_cat3)

  plot(m_BW_bam5_2_SEP_cat3, select=1, ylim=c(0, 4000),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat3)[1]) #GA
  plot(m_BW_bam5_2_SEP_cat3, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat3)[1]) #mat age
  plot(m_BW_bam5_2_SEP_cat3, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat3)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam5_2_SEP_cat3, select=4, ylim=c(3330, 3350),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat3)[1]) #month
  plot(m_BW_bam5_2_SEP_cat3, select=5, ylim=c(3150, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam5_2_SEP_cat3)[1]) #mean ssep
  
  beta <- coef(m_BW_bam5_2_SEP_cat3)
  Vb <- vcov(m_BW_bam5_2_SEP_cat3, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 1184367
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,20), 2)
```

# Stratification by SEP category 1: tertile
## Low SSEP

```{r}
m_BW_bam_L_SSEP1 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2  + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_L_SSEP1)  
  summary(m_BW_bam_L_SSEP1)
  plot(m_BW_bam_L_SSEP1, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP1)[1]) #GA
  plot(m_BW_bam_L_SSEP1, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP1)[1]) #mat age
  plot(m_BW_bam_L_SSEP1, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP1)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_L_SSEP1, select=4, ylim=c(3330, 3360),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP1)[1]) #month
  plot(m_BW_bam_L_SSEP1, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP1)[1]) #mean altitude
```

```{r}
  #  n <- 391036
  tab_m_BW_low <- round(head(estimates_cont(m_BW_bam_L_SSEP1, 391036), 18), 2)
  tab_m_BW_low
```

## Medium SSEP

```{r}
m_BW_bam_M_SSEP1 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_M_SSEP1)  
  summary(m_BW_bam_M_SSEP1)
  plot(m_BW_bam_M_SSEP1, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP1)[1]) #GA
  plot(m_BW_bam_M_SSEP1, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP1)[1]) #mat age
  plot(m_BW_bam_M_SSEP1, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP1)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_M_SSEP1, select=4, ylim=c(3330, 3360),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP1)[1]) #month
  plot(m_BW_bam_M_SSEP1, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP1)[1]) #mean altitude
```

```{r}
  #  n <- 409531
  tab_m_BW_medium <- round(head(estimates_cont(m_BW_bam_M_SSEP1, 409531), 18), 2)
  tab_m_BW_medium
```

## High SSEP

```{r}
m_BW_bam_H_SSEP1 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_H_SSEP1)  
  summary(m_BW_bam_H_SSEP1)
  plot(m_BW_bam_H_SSEP1, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP1)[1]) #GA
  plot(m_BW_bam_H_SSEP1, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP1)[1]) #mat age
  plot(m_BW_bam_H_SSEP1, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP1)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_H_SSEP1, select=4, ylim=c(3330, 3360),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP1)[1]) #month
  plot(m_BW_bam_H_SSEP1, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP1)[1]) #mean altitude
```

```{r}
  #  n <- 383800
  tab_m_BW_high <- round(head(estimates_cont(m_BW_bam_H_SSEP1, 383800), 18), 2)
  tab_m_BW_high
```


# Stratification by SEP category 2: 5th and 95th percentiles
## Low SSEP

```{r}
m_BW_bam_L_SSEP2 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2  + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_L_SSEP2)  
  summary(m_BW_bam_L_SSEP2)
  plot(m_BW_bam_L_SSEP2, select=1, ylim=c(0, 4300),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP2)[1]) #GA
  plot(m_BW_bam_L_SSEP2, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP2)[1]) #mat age
  plot(m_BW_bam_L_SSEP2, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP2)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_L_SSEP2, select=4, ylim=c(3300, 3340),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP2)[1]) #month
  plot(m_BW_bam_L_SSEP2, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP2)[1]) #mean altitude
  
  beta <- coef(m_BW_bam_L_SSEP2)
  Vb <- vcov(m_BW_bam_L_SSEP2, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 59433
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```

## Medium SSEP

```{r}
m_BW_bam_M_SSEP2 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_M_SSEP2)  
  summary(m_BW_bam_M_SSEP2)
  plot(m_BW_bam_M_SSEP2, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP2)[1]) #GA
  plot(m_BW_bam_M_SSEP2, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP2)[1]) #mat age
  plot(m_BW_bam_M_SSEP2, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP2)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_M_SSEP2, select=4, ylim=c(3320, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP2)[1]) #month
  plot(m_BW_bam_M_SSEP2, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP2)[1]) #mean altitude
  
  beta <- coef(m_BW_bam_M_SSEP2)
  Vb <- vcov(m_BW_bam_M_SSEP2, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 1066886
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```

## High SSEP

```{r}
m_BW_bam_H_SSEP3 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_H_SSEP2)  
  summary(m_BW_bam_H_SSEP3)
  plot(m_BW_bam_H_SSEP3, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #GA
  plot(m_BW_bam_H_SSEP3, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #mat age
  plot(m_BW_bam_H_SSEP3, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_H_SSEP3, select=4, ylim=c(3340, 3350),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #month
  plot(m_BW_bam_H_SSEP3, select=5, ylim=c(3000, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #mean altitude
    
  beta <- coef(m_BW_bam_H_SSEP3)
  Vb <- vcov(m_BW_bam_H_SSEP3, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 58048
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```

# Stratification by SEP category 3: lowest 20% vs. middle (2nd to 4th quintiles) vs. highest 20%.

## Low SSEP

```{r}
m_BW_bam_L_SSEP3 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2  + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_L_SSEP3)  
  summary(m_BW_bam_L_SSEP3)
  plot(m_BW_bam_L_SSEP3, select=1, ylim=c(0, 4300),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP3)[1]) #GA
  plot(m_BW_bam_L_SSEP3, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP3)[1]) #mat age
  plot(m_BW_bam_L_SSEP3, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP3)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_L_SSEP3, select=4, ylim=c(3300, 3340),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP3)[1]) #month
  plot(m_BW_bam_L_SSEP3, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_L_SSEP3)[1]) #mean altitude
  
  beta <- coef(m_BW_bam_L_SSEP3)
  Vb <- vcov(m_BW_bam_L_SSEP3, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 237107
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```

## Medium SSEP

```{r}
m_BW_bam_M_SSEP3 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_M_SSEP3)  
  summary(m_BW_bam_M_SSEP3)
  plot(m_BW_bam_M_SSEP3, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP3)[1]) #GA
  plot(m_BW_bam_M_SSEP3, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP3)[1]) #mat age
  plot(m_BW_bam_M_SSEP3, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP3)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_M_SSEP3, select=4, ylim=c(3320, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP3)[1]) #month
  plot(m_BW_bam_M_SSEP3, select=5, ylim=c(3100, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_M_SSEP3)[1]) #mean altitude
  
  beta <- coef(m_BW_bam_M_SSEP3)
  Vb <- vcov(m_BW_bam_M_SSEP3, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 710834
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```

## High SSEP

```{r}
m_BW_bam_H_SSEP3 <- bam(BW ~ s(GA_weeks) +  s(mat_age) + s(birth_Y_M_num) + s(month, bs="cc") + s(mean_Alt_mean2)+ parity_cat + sex + Urban3 + Language + mother_nationality_cat2 + civil_status3 + HW + GR + COVID_first_wave + COVID_second_wave, data=bevn_eco_in7_H_SSEP2)  
  summary(m_BW_bam_H_SSEP3)
  plot(m_BW_bam_H_SSEP3, select=1, ylim=c(0, 4100),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #GA
  plot(m_BW_bam_H_SSEP3, select=2, ylim=c(3200, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #mat age
  plot(m_BW_bam_H_SSEP3, select=3, ylim=c(3300, 3380),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1],  xlab  = "1 : 2007-01,     25: 2009-01,     50: 2011-02,    75: 2013-03,   100: 2015-04,    125: 2017-05, 150: 2019-06") #birth_Y_M_num
  plot(m_BW_bam_H_SSEP3, select=4, ylim=c(3340, 3350),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #month
  plot(m_BW_bam_H_SSEP3, select=5, ylim=c(3000, 3400),shade = TRUE, shade.col = "lightblue",  shift = coef(m_BW_bam_H_SSEP3)[1]) #mean altitude
  
  beta <- coef(m_BW_bam_H_SSEP3)
  Vb <- vcov(m_BW_bam_H_SSEP3, unconditional = TRUE)
  se <- sqrt(diag(Vb))
  n <- 58048
  d <- (abs(beta)/(sqrt(n)*se))
  my.ci <- data.frame(cbind(beta, lci = beta-1.96*se, uci = beta + 1.96*se, d))
  round(head(my.ci,18), 2) 
```